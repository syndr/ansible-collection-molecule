---
# tasks file for ec2_platform

- name: Dump vars
  ansible.builtin.debug:
    var: vars

- name: passed cfg is
  ansible.builtin.debug:
    var: ec2_platform_definition

# Merge the defaults with any options provided to this role
- name: Generate runtime configuration
  ansible.builtin.set_fact:
    ec2_platform: "{{ ec2_platform_defaults | combine(ec2_platform_definition | default({})) }}"

- name: dump platform info
  ansible.builtin.debug:
    var: ec2_platform

- name: Platform is deployed
  ansible.builtin.include_tasks: "{{ role_path }}/tasks/present.yml"
  when: ec2_platform_state == 'present'

- name: Platform is not deployed
  ansible.builtin.include_tasks: "{{ role_path }}/tasks/absent.yml"
  when: ec2_platform_state == 'absent'

